{"version":3,"sources":["../lib/util.js"],"names":["ID_LENGTH","ID_DIGITS","Util","n","i","rand","Math","floor","random","length","array","method","callback","iterate","done","err","hrtime","process","obj","pickBy","val","prop","includes","args","isString","sb","each","v","k","indexOf","isFunction","push","sort","join"],"mappings":";;;;;;qjBAAA;;;;;;AAMA;;;;;;;;AAEA,IAAMA,YAAY,EAAlB;AACA,IAAMC,YAAY,kBAAlB;;AAEA;;;;IAGqBC,I;;;;;;;;AACnB;;;;;+BAKmB;AACjB,UAAIC,IAAI,EAAR;AACA,WAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIJ,SAApB,EAA+BI,GAA/B,EAAoC;AAClC,YAAMC,OAAOC,KAAKC,KAAL,CAAWD,KAAKE,MAAL,KAAgBP,UAAUQ,MAArC,CAAb;;AAEA;AACA,YAAIJ,SAAS,CAAT,IAAcF,EAAEM,MAAF,GAAW,CAA7B,EAAgC;AAC9BN,eAAKF,UAAUI,IAAV,CAAL;AACD;AACF;AACD,aAAOF,CAAP;AACD;;AAED;;;;;;;;;;;;;2BAUeO,K,EAAOC,M,EAAQC,Q,EAAU;AACtC,UAAI,CAACF,MAAMD,MAAX,EAAmB;AACjBG;AACD,OAFD,MAEO;AACL,YAAIR,IAAI,CAAR;AACA,YAAMS,UAAU,SAAVA,OAAU,GAAY;AAC1B,cAAMC,OAAO,SAAPA,IAAO,CAAUC,GAAV,EAAe;AAC1B,gBAAIA,GAAJ,EAAS;AACPH,uBAASG,GAAT;AACD,aAFD,MAEO;AACLX,kBAAIA,IAAI,CAAR;AACA,kBAAIA,IAAIM,MAAMD,MAAd,EAAsB;AACpBI;AACD,eAFD,MAEO;AACLD;AACD;AACF;AACF,WAXD;;AAaAD,iBAAOD,MAAMN,CAAN,CAAP,EAAiBU,IAAjB,EAAuBV,CAAvB;AACD,SAfD;;AAiBAS;AACD;AACF;AACD;;;;;;;;;;;gCAQoB;AAClB,UAAMG,SAASC,QAAQD,MAAR,EAAf;AACA,aAAOV,KAAKC,KAAL,CAAWS,OAAO,CAAP,IAAY,OAAZ,GAAsBA,OAAO,CAAP,IAAY,IAA7C,CAAP;AACD;;AAED;;;;;;;;;;iCAOqBE,G,EAAK;AACxB,UAAIA,QAAQ,IAAZ,EAAkB,OAAOA,GAAP;;AAElB,aAAO,iBAAEC,MAAF,CAASD,GAAT,EAAc,UAAUE,GAAV,EAAeC,IAAf,EAAqB;AACxC,eAAO,CAAC,iBAAEC,QAAF,CAAWD,IAAX,EAAiB,GAAjB,CAAR;AACD,OAFM,CAAP;AAGD;;AAED;;;;;;;;;4BAMgBE,I,EAAM;AACpB,UAAI,iBAAEC,QAAF,CAAWD,IAAX,CAAJ,EAAsB;AACpB,eAAOA,IAAP;AACD;;AAEDA,aAAOA,QAAQ,EAAf;AACA,UAAIE,KAAK,EAAT;AACA,uBAAEC,IAAF,CAAOH,IAAP,EAAa,UAAUI,CAAV,EAAaC,CAAb,EAAgB;AAC3B,YAAI,CAAC,CAACA,EAAEC,OAAF,CAAU,GAAV,CAAF,IAAoB,CAAC,iBAAEC,UAAF,CAAaH,CAAb,CAAzB,EAA0C;AACxCF,aAAGM,IAAH,CAAQH,IAAI,GAAJ,GAAUD,CAAlB;AACD;AACF,OAJD;;AAMAF,SAAGO,IAAH;;AAEA,aAAOP,GAAGQ,IAAH,CAAQ,GAAR,CAAP;AACD;;;;;;kBAxGkB/B,I","file":"util.js","sourcesContent":["/*!\r\n * hemera\r\n * Copyright(c) 2016 Dustin Deus (deusdustin@gmail.com)\r\n * MIT Licensed\r\n */\r\n\r\nimport _ from 'lodash'\r\n\r\nconst ID_LENGTH = 16\r\nconst ID_DIGITS = '0123456789abcdef'\r\n\r\n/**\r\n * @class Util\r\n */\r\nexport default class Util {\r\n  /**\r\n   * @returns\r\n   *\r\n   * @memberOf Util\r\n   */\r\n  static randomId () {\r\n    let n = ''\r\n    for (let i = 0; i < ID_LENGTH; i++) {\r\n      const rand = Math.floor(Math.random() * ID_DIGITS.length)\r\n\r\n      // avoid leading zeroes\r\n      if (rand !== 0 || n.length > 0) {\r\n        n += ID_DIGITS[rand]\r\n      }\r\n    }\r\n    return n\r\n  }\r\n\r\n  /**\r\n   *\r\n   *\r\n   * @static\r\n   * @param {any} array\r\n   * @param {any} method\r\n   * @param {any} callback\r\n   *\r\n   * @memberOf Util\r\n   */\r\n  static serial (array, method, callback) {\r\n    if (!array.length) {\r\n      callback()\r\n    } else {\r\n      let i = 0\r\n      const iterate = function () {\r\n        const done = function (err) {\r\n          if (err) {\r\n            callback(err)\r\n          } else {\r\n            i = i + 1\r\n            if (i < array.length) {\r\n              iterate()\r\n            } else {\r\n              callback()\r\n            }\r\n          }\r\n        }\r\n\r\n        method(array[i], done, i)\r\n      }\r\n\r\n      iterate()\r\n    }\r\n  }\r\n  /**\r\n   * Get high resolution time in nanoseconds\r\n   *\r\n   * @static\r\n   * @returns\r\n   *\r\n   * @memberOf Util\r\n   */\r\n  static nowHrTime () {\r\n    const hrtime = process.hrtime()\r\n    return Math.floor(hrtime[0] * 1000000 + hrtime[1] / 1000)\r\n  }\r\n\r\n  /**\r\n   * @static\r\n   * @param {any} obj\r\n   * @returns\r\n   *\r\n   * @memberOf Util\r\n   */\r\n  static cleanPattern (obj) {\r\n    if (obj === null) return obj\r\n\r\n    return _.pickBy(obj, function (val, prop) {\r\n      return !_.includes(prop, '$')\r\n    })\r\n  }\r\n\r\n  /**\r\n   * @param {any} args\r\n   * @returns\r\n   *\r\n   * @memberOf Util\r\n   */\r\n  static pattern (args) {\r\n    if (_.isString(args)) {\r\n      return args\r\n    }\r\n\r\n    args = args || {}\r\n    let sb = []\r\n    _.each(args, function (v, k) {\r\n      if (!~k.indexOf('$') && !_.isFunction(v)) {\r\n        sb.push(k + ':' + v)\r\n      }\r\n    })\r\n\r\n    sb.sort()\r\n\r\n    return sb.join(',')\r\n  }\r\n}\r\n"]}