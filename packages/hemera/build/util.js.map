{"version":3,"sources":["../lib/util.js"],"names":["Util","array","method","callback","length","i","iterate","done","err","value","pass","randomBytes","toString","hrtime","process","Math","floor","obj","pickBy","val","prop","includes","args","isString","sb","each","v","k","indexOf","isFunction","push","sort","join","module","exports"],"mappings":";;;;AAEA;;;;;;AAMA;;;;AACA;;;;;;;;AAEA;;;IAGMA,I;;;;;;;;;AAEJ;;;;;;;;;2BAScC,K,EAAyBC,M,EAAkBC,Q,EAAoB;;AAE3E,UAAI,CAACF,MAAMG,MAAX,EAAmB;;AAEjBD;AACD,OAHD,MAGO;AAAA;;AAEL,cAAIE,IAAI,CAAR;;AAEA,cAAMC,UAAU,SAAVA,OAAU,GAAY;;AAE1B,gBAAMC,OAAO,SAAPA,IAAO,CAAUC,GAAV,EAAeC,KAAf,EAAsBC,IAAtB,EAA4B;;AAEvC,kBAAIF,GAAJ,EAAS;;AAEPL,yBAASK,GAAT;AACD,eAHD,MAGO,IAAI,CAACE,IAAD,IAASD,KAAb,EAAoB;;AAEzBN,yBAAS,IAAT,EAAeM,KAAf;AACD,eAHM,MAGA;;AAELJ,oBAAIA,IAAI,CAAR;;AAEA,oBAAIA,IAAIJ,MAAMG,MAAd,EAAsB;;AAEpBE;AACD,iBAHD,MAGO;;AAELH,2BAAS,IAAT,EAAeM,KAAf;AACD;AACF;AACF,aApBD;;AAsBAP,mBAAOD,MAAMI,CAAN,CAAP,EAAiBE,IAAjB,EAAuBF,CAAvB;AACD,WAzBD;;AA2BAC;AA/BK;AAgCN;AACF;AACD;;;;;;;;+BAKkB;;AAEhB,aAAO,iBAAOK,WAAP,CAAmB,EAAnB,EAAuBC,QAAvB,CAAgC,KAAhC,CAAP;AACD;;AAED;;;;;;;;;;;gCAQmB;;AAEjB,UAAMC,SAASC,QAAQD,MAAR,EAAf;AACA,aAAOE,KAAKC,KAAL,CAAWH,OAAO,CAAP,IAAY,OAAZ,GAAsBA,OAAO,CAAP,IAAY,IAA7C,CAAP;AACD;;AAED;;;;;;;;;;iCAOoBI,G,EAAK;;AAEvB,UAAIA,QAAQ,IAAZ,EAAkB,OAAOA,GAAP;;AAElB,aAAO,iBAAEC,MAAF,CAASD,GAAT,EAAc,UAAUE,GAAV,EAAeC,IAAf,EAA6B;AAChD,eAAO,CAAC,iBAAEC,QAAF,CAAWD,IAAX,EAAiB,GAAjB,CAAR;AACD,OAFM,CAAP;AAGD;;AAED;;;;;;;;;4BAMeE,I,EAAM;;AAEnB,UAAI,iBAAEC,QAAF,CAAWD,IAAX,CAAJ,EAAsB;AACpB,eAAOA,IAAP;AACD;;AAEDA,aAAOA,QAAQ,EAAf;AACA,UAAIE,KAAK,EAAT;AACA,uBAAEC,IAAF,CAAOH,IAAP,EAAa,UAAUI,CAAV,EAAaC,CAAb,EAAgB;AAC3B,YAAI,CAAC,CAACA,EAAEC,OAAF,CAAU,GAAV,CAAF,IAAoB,CAAC,iBAAEC,UAAF,CAAaH,CAAb,CAAzB,EAA0C;AACxCF,aAAGM,IAAH,CAAQH,IAAI,GAAJ,GAAUD,CAAlB;AACD;AACF,OAJD;;AAMAF,SAAGO,IAAH;;AAEA,aAAOP,GAAGQ,IAAH,CAAQ,GAAR,CAAP;AACD;;;;;;AAGHC,OAAOC,OAAP,GAAiBlC,IAAjB","file":"util.js","sourcesContent":["// @flow\n\n/*!\n * hemera\n * Copyright(c) 2016 Dustin Deus (deusdustin@gmail.com)\n * MIT Licensed\n */\n\nimport _ from 'lodash'\nimport Crypto from 'crypto'\n\n/**\n * @class Util\n */\nclass Util {\n\n  /**\n   *\n   *\n   * @param {Array<Function>} array\n   * @param {Function} method\n   * @param {Function} callback\n   *\n   * @memberOf Util\n   */\n  static serial(array: Array<Function> , method: Function, callback: Function) {\n\n    if (!array.length) {\n\n      callback()\n    } else {\n\n      let i = 0;\n\n      const iterate = function () {\n\n        const done = function (err, value, pass) {\n\n          if (err) {\n\n            callback(err)\n          } else if (!pass && value) {\n\n            callback(null, value)\n          } else {\n\n            i = i + 1\n\n            if (i < array.length) {\n\n              iterate()\n            } else {\n\n              callback(null, value)\n            }\n          }\n        }\n\n        method(array[i], done, i)\n      }\n\n      iterate()\n    }\n  }\n  /**\n   * @returns\n   *\n   * @memberOf Util\n   */\n  static randomId() {\n\n    return Crypto.randomBytes(16).toString('hex')\n  }\n\n  /**\n   * Get high resolution time in nanoseconds\n   *\n   * @static\n   * @returns\n   *\n   * @memberOf Util\n   */\n  static nowHrTime() {\n\n    const hrtime = process.hrtime()\n    return Math.floor(hrtime[0] * 1000000 + hrtime[1] / 1000)\n  }\n\n  /**\n   * @static\n   * @param {any} obj\n   * @returns\n   *\n   * @memberOf Util\n   */\n  static cleanPattern(obj) {\n\n    if (obj === null) return obj\n\n    return _.pickBy(obj, function (val, prop: string) {\n      return !_.includes(prop, '$')\n    })\n  }\n\n  /**\n   * @param {any} args\n   * @returns\n   *\n   * @memberOf Util\n   */\n  static pattern(args) {\n\n    if (_.isString(args)) {\n      return args\n    }\n\n    args = args || {}\n    let sb = []\n    _.each(args, function (v, k) {\n      if (!~k.indexOf('$') && !_.isFunction(v)) {\n        sb.push(k + ':' + v)\n      }\n    })\n\n    sb.sort()\n\n    return sb.join(',')\n  }\n}\n\nmodule.exports = Util\n"]}